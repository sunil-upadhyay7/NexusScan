const a0_0x2bae22=a0_0x3847;(function(_0x4d4ae6,_0x55ddcd){const _0x4fb7cb=a0_0x3847,_0x46f616=_0x4d4ae6();while(!![]){try{const _0x2cc7d2=-parseInt(_0x4fb7cb(0x164))/0x1+parseInt(_0x4fb7cb(0x148))/0x2+parseInt(_0x4fb7cb(0x1ff))/0x3*(parseInt(_0x4fb7cb(0x138))/0x4)+-parseInt(_0x4fb7cb(0x1cb))/0x5*(parseInt(_0x4fb7cb(0x1e3))/0x6)+-parseInt(_0x4fb7cb(0x1e8))/0x7*(-parseInt(_0x4fb7cb(0x19f))/0x8)+parseInt(_0x4fb7cb(0x1e5))/0x9+-parseInt(_0x4fb7cb(0x1f6))/0xa;if(_0x2cc7d2===_0x55ddcd)break;else _0x46f616['push'](_0x46f616['shift']());}catch(_0x2cf4b2){_0x46f616['push'](_0x46f616['shift']());}}}(a0_0xb30c,0x3083c));function a0_0x3847(_0x1ed6aa,_0x3f2cda){const _0x236a80=a0_0xb30c();return a0_0x3847=function(_0x77879c,_0x751c1d){_0x77879c=_0x77879c-0xec;let _0xb30cd2=_0x236a80[_0x77879c];return _0xb30cd2;},a0_0x3847(_0x1ed6aa,_0x3f2cda);}const a0_0x751c1d=(function(){let _0x13454c=!![];return function(_0x40c0cc,_0x24fdad){const _0x1f678a=_0x13454c?function(){const _0x4c93e7=a0_0x3847;if(_0x24fdad){const _0x3c8793=_0x24fdad[_0x4c93e7(0x20b)](_0x40c0cc,arguments);return _0x24fdad=null,_0x3c8793;}}:function(){};return _0x13454c=![],_0x1f678a;};}()),a0_0x77879c=a0_0x751c1d(this,function(){const _0x58e5e6=a0_0x3847;return a0_0x77879c['toString']()['search'](_0x58e5e6(0x10a))[_0x58e5e6(0x1e0)]()['constructor'](a0_0x77879c)[_0x58e5e6(0x1a7)]('(((.+)+)+)+$');});a0_0x77879c();function a0_0xb30c(){const _0x320795=['NexusScan:\x20Timeout\x20waiting\x20for\x20urlscan.io\x20scan\x20results','VT_API_KEY','324452ymZSJG','getFeedback','forceRescan','getTree','length','\x20unique\x20IP\x20addresses',',\x20error:','NexusScan:\x20Flattened\x20bookmarks:','requests','fulfilled','size','runtime','round','unshift','onInstalled','storage','values','parentId','https://urlscan.io/api/v1/scan/','comment','NexusScan:\x20Bulk\x20scan\x20completed:\x20','type','country','getUserFeedback','getBookmarkScanResults','addListener','getCurrentTab','clearCache','342496YJtUoh','catch','safe','NexusScan\x20v1.0.0','NexusScan:\x20Failed\x20to\x20get\x20history:','includes','Unknown\x20error','from','NexusScan:\x20VirusTotal\x20scan\x20failed:','remove','has','verdict','URLSCAN_API_KEY','total','malicious','Invalid\x20domain','loadApiKeys','map','blockURL','NexusScan:\x20Invalid\x20urlscan.io\x20API\x20key','Untitled','NexusScan\x20background\x20script\x20error:','protocol','false_positive','NexusScan:\x20VirusTotal\x20rate\x20limit\x20exceeded','POST','wappa','substr','urlscanVisibility','NexusScan:\x20No\x20VirusTotal\x20API\x20key\x20available','trim','lists','sync','NexusScan:\x20Failed\x20to\x20submit\x20URL\x20to\x20VirusTotal\x20(','children','feedbackId','NexusScan:\x20Failed\x20to\x20export\x20history:','pollUrlscanResults','Bookmarks\x20API\x20not\x20available','getVirusTotalReport','NexusScan:\x20Comprehensive\x20scan\x20error:','NexusScan:\x20Error\x20retrieving\x20results\x20(','entries','cleanCache','totalRatings','filter','initializeMonitoring','generateHistoryId','bookmarks','scanDuration','push','NexusScan:\x20Bookmark\x20scan\x20results\x20cleared','result','findIndex','status','string','NexusScan:\x20Domain\x20resolution\x20failed\x20-\x20','private','NexusScan:\x20urlscan.io\x20error\x20(','8pjWAEA','scanURL','tabs','toLocaleString','NexusScan:\x20urlscan.io\x20endpoint\x20not\x20found','meta','generateThreats','onMessage','search','set','reduce','NexusScan:\x20Initialized\x20storage\x20area:\x20','message','getHistory','rating','task','dateAdded','application/x-www-form-urlencoded','uuid','NexusScan:\x20Failed\x20to\x20save\x20scan\x20to\x20history:','NexusScan:\x20Successfully\x20extracted\x20','No\x20urlscan.io\x20API\x20key\x20configured','NexusScan:\x20Timeout\x20waiting\x20for\x20urlscan.io\x20results','NexusScan:\x20Failed\x20to\x20get\x20user\x20feedback:','https://urlscan.io/api/v1/result/','vtApiKey','harmless','NexusScan:\x20API\x20keys\x20loaded:','NexusScan:\x20Polling\x20urlscan.io\x20results\x20for\x20UUID:','\x20security\x20vendors\x20flagged\x20this\x20URL\x20as\x20malicious','handleMessage','https://urlscan.io/result/','NexusScan:\x20Final\x20polling\x20attempt\x20failed:','last_analysis_date','\x20entries','stringify','extractIPAddresses','NexusScan:\x20VirusTotal\x20submission\x20error:','min','time','page','nexusscan_feedback_','processors','NexusScan:\x20Bookmark\x20tree\x20retrieved:','2645WrWMWA','last_analysis_stats','title','):\x20','calculateCombinedScore','URLSCAN_VISIBILITY','NexusScan:\x20Invalid\x20bookmark\x20URL:','NexusScan\x20cache\x20cleared','NexusScan:\x20urlscan.io\x20submission\x20error:','NexusScan:\x20Invalid\x20URL\x20format\x20provided','generateReportId','unknown','virustotal','threats','NexusScan:\x20Invalid\x20request\x20-\x20','flattenBookmarks','exportHistory','https:','brands','scanning','NexusScan:\x20Feedback\x20deleted:','toString','callback','get','240YVlJHx','limit','980910MrPAXw','deleteFeedback','undetected','2263884AUSwMD','nexusscan_community_feedback','onChanged','score','NexusScan:\x20Returning\x20cached\x20result\x20for:','complete','exportBookmarkResults','reason','NexusScan:\x20Community\x20feedback\x20submitted:','NexusScan:\x20Starting\x20bulk\x20scan\x20of\x20','urlscanApiKey','NexusScan:\x20Failed\x20to\x20scan\x20bookmark\x20','reportURL','NexusScan:\x20Saved\x20bookmark\x20scan\x20results:','3530040XmXqkg','maxCacheSize','https://www.virustotal.com/gui/url/','\x20-\x20Score:\x20','now','getFeedbackStats','nexusscan_scan_history','json','userAgent','12ISlihX','ipStats','calculateCommunityScore','http:','description','comprehensiveScan','initializeStorage','Unknown','log','verdicts','NexusScan:\x20urlscan.io\x20scan\x20failed:','scanBookmarksBulk','apply','domain','local','generateFeedbackId','security-scan','delete','stats','clearHistory','bookmarks\x20found','clearBookmarkScanResults','NexusScan:\x20Rate\x20limited\x20while\x20polling,\x20waiting\x20longer...','geoip','NexusScan:\x20urlscan.io\x20scan\x20submitted:','\x20bookmarks','No\x20VirusTotal\x20API\x20key\x20configured','NexusScan:\x20Cache\x20cleaned:\x20removed\x20','NexusScan:\x20Scanned\x20bookmark:\x20','attributes','asn','report','submitUrlToVirusTotal','NexusScan:\x20Failed\x20to\x20save\x20bookmark\x20scan\x20results:','sort','evidence','nexusscan_scan_','format','saveBookmarkScanResults','Unknown\x20action','data','NexusScan:\x20Failed\x20to\x20clear\x20history:','forEach','error','NexusScan:\x20Scan\x20still\x20processing,\x20retry\x20','(((.+)+)+)+$','NexusScan:\x20Failed\x20to\x20submit\x20feedback:','allSettled','NexusScan:\x20Filtered\x20','NexusScan:\x20Invalid\x20VirusTotal\x20API\x20key','url=','\x20security\x20vendors\x20flagged\x20this\x20URL\x20as\x20suspicious','isArray','NexusScan:\x20urlscan.io\x20results\x20retrieved\x20successfully','sources','splice','NexusScan:\x20Top\x20IPs\x20found:','Clean','response','nexusscan_url_reports','category','NexusScan:\x20Failed\x20to\x20delete\x20feedback:','ips','VirusTotal\x20scan\x20failed','Invalid\x20protocol.\x20Only\x20HTTP\x20and\x20HTTPS\x20are\x20supported.','url','value','results','remoteIPAddress','lastScanned','slice','NexusScan:\x20Failed\x20to\x20export\x20bookmark\x20results:','timestamp','\x20non-HTTP(S)\x20bookmarks','https://www.virustotal.com/api/v3/urls','submitFeedback','🔍\x20NexusScan\x20extension\x20installed\x20-\x20Scan\x20Smarter.\x20Stay\x20Safer','saveToHistory','update','statusText','communityFeedback','nexusscan','submitUrlscan','getHistoryStats','NexusScan/1.0','Missing\x20URL','urlscan.io\x20scan\x20failed','random','cache','getBookmarks','toISOString','320748VELsLl','NexusScan:\x20Comprehensive\x20scan\x20completed\x20with\x20score:','request','replace','clean','NexusScan:\x20VirusTotal\x20error\x20(','NexusScan:\x20VirusTotal\x20error:','urlscan.io\x20detected\x20malicious\x20behavior','getStats','suspicious','clear','NexusScan:\x20Failed\x20to\x20clear\x20bookmark\x20scan\x20results:','urlscan','nexusscan_bookmark_scan_results'];a0_0xb30c=function(){return _0x320795;};return a0_0xb30c();}class ThreatIntelligence{constructor(){const _0x4a17a0=a0_0x3847;this[_0x4a17a0(0x147)]=null,this[_0x4a17a0(0x170)]=null,this[_0x4a17a0(0x135)]=new Map(),this[_0x4a17a0(0x1f7)]=0x64,this[_0x4a17a0(0x192)](),this[_0x4a17a0(0x174)](),this[_0x4a17a0(0x205)]();}async[a0_0x2bae22(0x205)](){const _0x2cfc70=a0_0x2bae22;try{const _0x1c7b43=[_0x2cfc70(0x1fc),_0x2cfc70(0x1e9),_0x2cfc70(0x145),_0x2cfc70(0x118)];for(const _0x1f84f7 of _0x1c7b43){const _0x2bce92=await chrome['storage'][_0x2cfc70(0x20d)][_0x2cfc70(0x1e2)](_0x1f84f7);!_0x2bce92[_0x1f84f7]&&(await chrome['storage'][_0x2cfc70(0x20d)][_0x2cfc70(0x1a8)]({[_0x1f84f7]:[]}),console[_0x2cfc70(0x207)](_0x2cfc70(0x1aa)+_0x1f84f7));}}catch(_0x225348){console[_0x2cfc70(0x108)]('NexusScan:\x20Failed\x20to\x20initialize\x20storage:',_0x225348);}}async['loadApiKeys'](){const _0x42c7a7=a0_0x2bae22;try{const _0x433ff1=await chrome[_0x42c7a7(0x157)][_0x42c7a7(0x184)][_0x42c7a7(0x1e2)](['vtApiKey','urlscanApiKey',_0x42c7a7(0x180)]);this[_0x42c7a7(0x147)]=_0x433ff1[_0x42c7a7(0x1b8)],this[_0x42c7a7(0x170)]=_0x433ff1[_0x42c7a7(0x1f2)],this[_0x42c7a7(0x1d0)]=_0x433ff1[_0x42c7a7(0x180)]||_0x42c7a7(0x19d),console[_0x42c7a7(0x207)](_0x42c7a7(0x1ba),{'hasVT':!!this[_0x42c7a7(0x147)],'hasUrlscan':!!this['URLSCAN_API_KEY'],'visibility':this[_0x42c7a7(0x1d0)]});}catch(_0x43e011){console['error']('NexusScan:\x20Failed\x20to\x20load\x20API\x20keys:',_0x43e011);}}[a0_0x2bae22(0x192)](){const _0xc7eef4=a0_0x2bae22;chrome[_0xc7eef4(0x153)][_0xc7eef4(0x1a6)][_0xc7eef4(0x161)]((_0x2ed22b,_0x16b76b,_0x41809d)=>{const _0x2f775d=_0xc7eef4;return this[_0x2f775d(0x1bd)](_0x2ed22b,_0x16b76b,_0x41809d),!![];}),chrome['storage'][_0xc7eef4(0x1ea)]['addListener'](_0x38052d=>{const _0x144fb6=_0xc7eef4;(_0x38052d['vtApiKey']||_0x38052d[_0x144fb6(0x1f2)]||_0x38052d[_0x144fb6(0x180)])&&this[_0x144fb6(0x174)]();}),setInterval(()=>{const _0x2d79ee=_0xc7eef4;this[_0x2d79ee(0x18f)]();},0x1e*0x3c*0x3e8);}[a0_0x2bae22(0x18f)](){const _0x1f7afe=a0_0x2bae22;if(this[_0x1f7afe(0x135)][_0x1f7afe(0x152)]>this[_0x1f7afe(0x1f7)]){const _0x574aa3=Array[_0x1f7afe(0x16b)](this[_0x1f7afe(0x135)][_0x1f7afe(0x18e)]());_0x574aa3[_0x1f7afe(0xff)]((_0x4b1598,_0x24258d)=>_0x4b1598[0x1][_0x1f7afe(0x125)]-_0x24258d[0x1][_0x1f7afe(0x125)]);const _0x20d746=Math['floor'](this[_0x1f7afe(0x135)][_0x1f7afe(0x152)]*0.2);for(let _0x27a99b=0x0;_0x27a99b<_0x20d746;_0x27a99b++){this[_0x1f7afe(0x135)][_0x1f7afe(0xee)](_0x574aa3[_0x27a99b][0x0]);}console[_0x1f7afe(0x207)](_0x1f7afe(0xf8)+_0x20d746+_0x1f7afe(0x1c1));}}async[a0_0x2bae22(0x1bd)](_0x2eb2f2,_0x39d759,_0x3b8bb5){const _0x2b22fa=a0_0x2bae22;try{switch(_0x2eb2f2['action']){case _0x2b22fa(0x1a0):const _0x14dc47=await this[_0x2b22fa(0x204)](_0x2eb2f2[_0x2b22fa(0x11e)],_0x2eb2f2[_0x2b22fa(0x14a)]);_0x3b8bb5({'success':!![],'data':_0x14dc47});break;case _0x2b22fa(0x162):const _0x1e74ab=await chrome[_0x2b22fa(0x1a1)]['query']({'active':!![],'currentWindow':!![]});_0x3b8bb5({'success':!![],'data':_0x1e74ab[0x0]});break;case _0x2b22fa(0x176):await this[_0x2b22fa(0x176)](_0x2eb2f2['url'],_0x2eb2f2['tabId']),_0x3b8bb5({'success':!![]});break;case _0x2b22fa(0x163):this['cache'][_0x2b22fa(0x142)](),_0x3b8bb5({'success':!![],'message':_0x2b22fa(0x1d2)});break;case _0x2b22fa(0x1ac):const _0x1c7b29=await this['getHistory'](_0x2eb2f2[_0x2b22fa(0x1e4)]);_0x3b8bb5({'success':!![],'data':_0x1c7b29});break;case _0x2b22fa(0x130):const _0x5d19e6=await this[_0x2b22fa(0x130)]();_0x3b8bb5({'success':!![],'data':_0x5d19e6});break;case _0x2b22fa(0xf0):const _0xdae3b2=await this['clearHistory']();_0x3b8bb5({'success':!![],'cleared':_0xdae3b2});break;case _0x2b22fa(0x1db):const _0x300899=await this[_0x2b22fa(0x1db)](_0x2eb2f2[_0x2b22fa(0x102)]);_0x3b8bb5({'success':!![],'data':_0x300899});break;case _0x2b22fa(0x128):const _0x195111=await this[_0x2b22fa(0x128)](_0x2eb2f2['feedback']);_0x3b8bb5({'success':!![],'data':_0x195111});break;case _0x2b22fa(0x149):const _0xd831e8=await this[_0x2b22fa(0x149)](_0x2eb2f2['url']);_0x3b8bb5({'success':!![],'data':_0xd831e8});break;case _0x2b22fa(0x1fb):const _0x2fa1e0=await this['getFeedbackStats']();_0x3b8bb5({'success':!![],'data':_0x2fa1e0});break;case _0x2b22fa(0x1f4):const _0x5c10d7=await this[_0x2b22fa(0x1f4)](_0x2eb2f2[_0x2b22fa(0xfc)]);_0x3b8bb5({'success':!![],'data':_0x5c10d7});break;case _0x2b22fa(0x15f):const _0x276a94=await this['getUserFeedback']();_0x3b8bb5({'success':!![],'data':_0x276a94});break;case _0x2b22fa(0x1e6):const _0x3c3e92=await this[_0x2b22fa(0x1e6)](_0x2eb2f2[_0x2b22fa(0x187)]);_0x3b8bb5({'success':!![],'data':_0x3c3e92});break;case _0x2b22fa(0x136):const _0x54a0f6=await this[_0x2b22fa(0x136)]();_0x3b8bb5({'success':!![],'data':_0x54a0f6});break;case'getBookmarkScanResults':const _0x4ed733=await this[_0x2b22fa(0x160)]();_0x3b8bb5({'success':!![],'data':_0x4ed733});break;case _0x2b22fa(0x103):const _0x451355=await this[_0x2b22fa(0x103)](_0x2eb2f2[_0x2b22fa(0x120)]);_0x3b8bb5({'success':!![],'data':_0x451355});break;case _0x2b22fa(0x20a):const _0x43559a=await this[_0x2b22fa(0x20a)](_0x2eb2f2[_0x2b22fa(0x194)],_0x2eb2f2[_0x2b22fa(0x1e1)]);_0x3b8bb5({'success':!![],'data':_0x43559a});break;case _0x2b22fa(0xf2):const _0xd25a9d=await this[_0x2b22fa(0xf2)]();_0x3b8bb5({'success':!![],'data':_0xd25a9d});break;case _0x2b22fa(0x1ee):const _0x297cf9=await this[_0x2b22fa(0x1ee)]();_0x3b8bb5({'success':!![],'data':_0x297cf9});break;case _0x2b22fa(0x140):_0x3b8bb5({'success':!![],'data':{'cacheSize':this['cache'][_0x2b22fa(0x152)],'hasVTKey':!!this[_0x2b22fa(0x147)],'hasUrlscanKey':!!this[_0x2b22fa(0x170)]}});break;default:_0x3b8bb5({'success':![],'error':_0x2b22fa(0x104)});}}catch(_0x6994f3){console[_0x2b22fa(0x108)](_0x2b22fa(0x179),_0x6994f3),_0x3b8bb5({'success':![],'error':_0x6994f3[_0x2b22fa(0x1ab)]});}}async[a0_0x2bae22(0x12f)](_0x38fa03){const _0x4c9afb=a0_0x2bae22;if(!this[_0x4c9afb(0x170)])return console[_0x4c9afb(0x207)]('NexusScan:\x20No\x20urlscan.io\x20API\x20key\x20available'),{'error':_0x4c9afb(0x1b4)};try{console[_0x4c9afb(0x207)]('NexusScan:\x20Submitting\x20URL\x20to\x20urlscan.io:',_0x38fa03);const _0x2a8a44=await fetch(_0x4c9afb(0x15a),{'method':_0x4c9afb(0x17d),'headers':{'API-Key':this[_0x4c9afb(0x170)],'Content-Type':'application/json','User-Agent':_0x4c9afb(0x131)},'body':JSON[_0x4c9afb(0x1c2)]({'url':_0x38fa03,'visibility':this[_0x4c9afb(0x1d0)]||_0x4c9afb(0x19d),'tags':[_0x4c9afb(0x12e),_0x4c9afb(0xed)]})});if(!_0x2a8a44['ok']){const _0x49e610=await _0x2a8a44[_0x4c9afb(0x1fd)]()['catch'](()=>({'message':_0x4c9afb(0x16a)}));switch(_0x2a8a44[_0x4c9afb(0x19a)]){case 0x190:if(_0x49e610[_0x4c9afb(0x1ab)]&&_0x49e610[_0x4c9afb(0x1ab)]['includes']('DNS\x20Error'))throw new Error(_0x4c9afb(0x19c)+(_0x49e610[_0x4c9afb(0x203)]||_0x4c9afb(0x173)));else{if(_0x49e610['message']&&_0x49e610[_0x4c9afb(0x1ab)][_0x4c9afb(0x169)](_0x4c9afb(0x132)))throw new Error(_0x4c9afb(0x1d4));else throw new Error(_0x4c9afb(0x1d9)+(_0x49e610['message']||'Bad\x20request'));}case 0x191:throw new Error(_0x4c9afb(0x177));case 0x1ad:throw new Error('NexusScan:\x20Rate\x20limit\x20exceeded.\x20Please\x20wait\x20before\x20scanning\x20again.');case 0x194:throw new Error(_0x4c9afb(0x1a3));default:throw new Error(_0x4c9afb(0x19e)+_0x2a8a44['status']+_0x4c9afb(0x1ce)+(_0x49e610[_0x4c9afb(0x1ab)]||_0x2a8a44[_0x4c9afb(0x12c)]));}}const _0x536e94=await _0x2a8a44[_0x4c9afb(0x1fd)]();console[_0x4c9afb(0x207)](_0x4c9afb(0xf5),_0x536e94[_0x4c9afb(0x1b1)]);const _0x2e9cc1=await this[_0x4c9afb(0x189)](_0x536e94[_0x4c9afb(0x1b1)]);return _0x2e9cc1;}catch(_0x6237d0){return console[_0x4c9afb(0x108)](_0x4c9afb(0x1d3),_0x6237d0),{'error':_0x6237d0[_0x4c9afb(0x1ab)]};}}async[a0_0x2bae22(0x189)](_0x569547){const _0x3eedef=a0_0x2bae22,_0x447caf=0xf,_0x4f9300=0x2710;console['log'](_0x3eedef(0x1bb),_0x569547);for(let _0x5e7b16=0x0;_0x5e7b16<_0x447caf;_0x5e7b16++){try{const _0x16a617=await fetch(_0x3eedef(0x1b7)+_0x569547+'/',{'headers':{'API-Key':this['URLSCAN_API_KEY'],'User-Agent':_0x3eedef(0x131)}});if(_0x16a617['ok']){const _0x70fd60=await _0x16a617['json']();return console[_0x3eedef(0x207)](_0x3eedef(0x112)),{'uuid':_0x569547,'verdict':_0x70fd60[_0x3eedef(0x208)]?.['overall']?.[_0x3eedef(0x1eb)]||0x0>0x32?_0x3eedef(0x172):_0x70fd60[_0x3eedef(0x208)]?.['overall']?.[_0x3eedef(0x1eb)]||0x0>0x19?_0x3eedef(0x141):_0x3eedef(0x13c),'scan_url':_0x3eedef(0x1be)+_0x569547+'/','screenshot':_0x70fd60[_0x3eedef(0x1ae)]?.['screenshotURL']||null,'page_info':{'domain':_0x70fd60['page']?.[_0x3eedef(0x20c)]||null,'ip':_0x70fd60['page']?.['ip']||null,'country':_0x70fd60['page']?.[_0x3eedef(0x15e)]||null,'server':_0x70fd60[_0x3eedef(0x1c7)]?.['server']||null},'ip_addresses':this[_0x3eedef(0x1c3)](_0x70fd60),'stats':{'malicious':_0x70fd60[_0x3eedef(0xef)]?.['malicious']||0x0,'suspicious':_0x70fd60[_0x3eedef(0xef)]?.[_0x3eedef(0x141)]||0x0,'requests':_0x70fd60['stats']?.['requests']||0x0},'technologies':_0x70fd60[_0x3eedef(0x1a4)]?.[_0x3eedef(0x1c9)]?.[_0x3eedef(0x17e)]?.[_0x3eedef(0x105)]||[],'scan_time':_0x70fd60[_0x3eedef(0x1ae)]?.[_0x3eedef(0x1c6)]||Date[_0x3eedef(0x1fa)]()};}else{if(_0x16a617[_0x3eedef(0x19a)]===0x194){if(_0x5e7b16<_0x447caf-0x1){console[_0x3eedef(0x207)](_0x3eedef(0x109)+(_0x5e7b16+0x1)+'/'+_0x447caf),await new Promise(_0x4505a6=>setTimeout(_0x4505a6,_0x4f9300));continue;}else throw new Error(_0x3eedef(0x1b5));}else{if(_0x16a617[_0x3eedef(0x19a)]===0x19a)throw new Error('NexusScan:\x20Scan\x20result\x20was\x20deleted\x20or\x20expired');else{if(_0x16a617[_0x3eedef(0x19a)]===0x1ad){console[_0x3eedef(0x207)](_0x3eedef(0xf3)),await new Promise(_0x4ad1ab=>setTimeout(_0x4ad1ab,_0x4f9300*0x2));continue;}else{const _0x27a656=await _0x16a617['json']()[_0x3eedef(0x165)](()=>({'message':'Unknown\x20error'}));throw new Error(_0x3eedef(0x18d)+_0x16a617[_0x3eedef(0x19a)]+_0x3eedef(0x1ce)+_0x27a656[_0x3eedef(0x1ab)]);}}}}}catch(_0xc98ca7){if(_0x5e7b16===_0x447caf-0x1){console[_0x3eedef(0x108)](_0x3eedef(0x1bf),_0xc98ca7);throw _0xc98ca7;}console[_0x3eedef(0x207)]('NexusScan:\x20Polling\x20retry\x20'+(_0x5e7b16+0x1)+_0x3eedef(0x14e),_0xc98ca7[_0x3eedef(0x1ab)]),await new Promise(_0x5de46b=>setTimeout(_0x5de46b,_0x4f9300));}}throw new Error(_0x3eedef(0x146));}['extractIPAddresses'](_0x9e7e51){const _0x4f41bc=a0_0x2bae22,_0x93bed3=[],_0x25ec81=new Map();try{console[_0x4f41bc(0x207)]('NexusScan:\x20Extracting\x20IP\x20addresses\x20from\x20urlscan.io\x20data');_0x9e7e51[_0x4f41bc(0x150)]&&Array['isArray'](_0x9e7e51['requests'])&&_0x9e7e51[_0x4f41bc(0x150)]['forEach'](_0x20c785=>{const _0x5afc75=_0x4f41bc;if(_0x20c785[_0x5afc75(0x13a)]&&_0x20c785[_0x5afc75(0x13a)]['ip']){const _0x390aa0=_0x20c785[_0x5afc75(0x13a)]['ip'],_0x43f377=_0x20c785['request'][_0x5afc75(0x15e)]||'Unknown',_0x263e4a=_0x20c785[_0x5afc75(0x13a)][_0x5afc75(0xfb)]||null;!_0x25ec81['has'](_0x390aa0)?_0x25ec81[_0x5afc75(0x1a8)](_0x390aa0,{'ip':_0x390aa0,'country':_0x43f377,'asn':_0x263e4a,'requests':0x1}):_0x25ec81[_0x5afc75(0x1e2)](_0x390aa0)[_0x5afc75(0x150)]++;}});_0x9e7e51[_0x4f41bc(0x183)]&&_0x9e7e51[_0x4f41bc(0x183)][_0x4f41bc(0x11b)]&&Array[_0x4f41bc(0x111)](_0x9e7e51[_0x4f41bc(0x183)][_0x4f41bc(0x11b)])&&_0x9e7e51[_0x4f41bc(0x183)][_0x4f41bc(0x11b)][_0x4f41bc(0x107)](_0x270e4b=>{const _0x1980fa=_0x4f41bc;_0x270e4b&&typeof _0x270e4b===_0x1980fa(0x19b)&&(!_0x25ec81[_0x1980fa(0x16e)](_0x270e4b)&&_0x25ec81[_0x1980fa(0x1a8)](_0x270e4b,{'ip':_0x270e4b,'country':_0x1980fa(0x206),'asn':null,'requests':0x1}));});_0x9e7e51['data']&&_0x9e7e51[_0x4f41bc(0x105)][_0x4f41bc(0x150)]&&Array[_0x4f41bc(0x111)](_0x9e7e51[_0x4f41bc(0x105)][_0x4f41bc(0x150)])&&_0x9e7e51[_0x4f41bc(0x105)][_0x4f41bc(0x150)][_0x4f41bc(0x107)](_0x4be930=>{const _0x31b523=_0x4f41bc;if(_0x4be930['response']&&_0x4be930[_0x31b523(0x117)]['response']&&_0x4be930[_0x31b523(0x117)][_0x31b523(0x117)]['remoteIPAddress']){const _0x1aec92=_0x4be930[_0x31b523(0x117)][_0x31b523(0x117)][_0x31b523(0x121)],_0x598ded=_0x4be930[_0x31b523(0xf4)]&&_0x4be930['geoip'][_0x31b523(0x15e)]?_0x4be930[_0x31b523(0xf4)][_0x31b523(0x15e)]:'Unknown';!_0x25ec81[_0x31b523(0x16e)](_0x1aec92)?_0x25ec81[_0x31b523(0x1a8)](_0x1aec92,{'ip':_0x1aec92,'country':_0x598ded,'asn':null,'requests':0x1}):_0x25ec81[_0x31b523(0x1e2)](_0x1aec92)[_0x31b523(0x150)]++;}});if(_0x9e7e51[_0x4f41bc(0x208)]&&_0x9e7e51['verdicts'][_0x4f41bc(0x144)]&&_0x9e7e51[_0x4f41bc(0x208)][_0x4f41bc(0x144)][_0x4f41bc(0x1dd)]){}_0x9e7e51['stats']&&_0x9e7e51['stats'][_0x4f41bc(0x200)]&&Array[_0x4f41bc(0x111)](_0x9e7e51[_0x4f41bc(0xef)]['ipStats'])&&_0x9e7e51[_0x4f41bc(0xef)][_0x4f41bc(0x200)][_0x4f41bc(0x107)](_0x172a70=>{const _0x5509f9=_0x4f41bc;if(_0x172a70['ip']){const _0x17ce1f=_0x172a70['ip'];!_0x25ec81[_0x5509f9(0x16e)](_0x17ce1f)&&_0x25ec81['set'](_0x17ce1f,{'ip':_0x17ce1f,'country':_0x172a70[_0x5509f9(0x15e)]||_0x5509f9(0x206),'asn':_0x172a70[_0x5509f9(0xfb)]||null,'requests':_0x172a70[_0x5509f9(0x150)]||0x1});}});const _0x5863e3=Array[_0x4f41bc(0x16b)](_0x25ec81[_0x4f41bc(0x158)]())[_0x4f41bc(0xff)]((_0x3657bc,_0x38429d)=>_0x38429d[_0x4f41bc(0x150)]-_0x3657bc[_0x4f41bc(0x150)]);if(_0x9e7e51[_0x4f41bc(0x1c7)]&&_0x9e7e51[_0x4f41bc(0x1c7)]['ip']){const _0x2ab8e4=_0x9e7e51[_0x4f41bc(0x1c7)]['ip'],_0x2af1af=_0x5863e3[_0x4f41bc(0x199)](_0x191355=>_0x191355['ip']===_0x2ab8e4);if(_0x2af1af>0x0){const _0x5df3d9=_0x5863e3[_0x4f41bc(0x114)](_0x2af1af,0x1)[0x0];_0x5863e3['unshift'](_0x5df3d9);}else _0x2af1af===-0x1&&_0x5863e3['unshift']({'ip':_0x2ab8e4,'country':_0x9e7e51[_0x4f41bc(0x1c7)][_0x4f41bc(0x15e)]||'Unknown','asn':_0x9e7e51['page'][_0x4f41bc(0xfb)]||null,'requests':0x1});}return console[_0x4f41bc(0x207)](_0x4f41bc(0x1b3)+_0x5863e3[_0x4f41bc(0x14c)]+_0x4f41bc(0x14d)),_0x5863e3['length']>0x0&&console['log'](_0x4f41bc(0x115),_0x5863e3[_0x4f41bc(0x123)](0x0,0x5)['map'](_0x5c4adf=>_0x5c4adf['ip']+'\x20('+_0x5c4adf[_0x4f41bc(0x15e)]+')')),_0x5863e3;}catch(_0x5f1292){console[_0x4f41bc(0x108)]('NexusScan:\x20Failed\x20to\x20extract\x20IP\x20addresses:',_0x5f1292);if(_0x9e7e51['page']&&_0x9e7e51[_0x4f41bc(0x1c7)]['ip'])return[{'ip':_0x9e7e51[_0x4f41bc(0x1c7)]['ip'],'country':_0x9e7e51[_0x4f41bc(0x1c7)][_0x4f41bc(0x15e)]||_0x4f41bc(0x206),'asn':null,'requests':0x1}];return[];}}async['getVirusTotalReport'](_0x48ac76){const _0x4b48ee=a0_0x2bae22;if(!this[_0x4b48ee(0x147)])return console[_0x4b48ee(0x207)](_0x4b48ee(0x181)),{'error':_0x4b48ee(0xf7)};try{const _0x510aec=btoa(_0x48ac76)[_0x4b48ee(0x13b)](/\+/g,'-')[_0x4b48ee(0x13b)](/\//g,'_')[_0x4b48ee(0x13b)](/=+$/,''),_0x15254c=await fetch('https://www.virustotal.com/api/v3/urls/'+_0x510aec,{'headers':{'x-apikey':this[_0x4b48ee(0x147)],'User-Agent':_0x4b48ee(0x131)}});if(!_0x15254c['ok']){if(_0x15254c[_0x4b48ee(0x19a)]===0x194)return await this[_0x4b48ee(0xfd)](_0x48ac76);else{if(_0x15254c[_0x4b48ee(0x19a)]===0x191||_0x15254c[_0x4b48ee(0x19a)]===0x193)throw new Error(_0x4b48ee(0x10e));else{if(_0x15254c[_0x4b48ee(0x19a)]===0x1ad)throw new Error(_0x4b48ee(0x17c));else throw new Error(_0x4b48ee(0x13d)+_0x15254c['status']+_0x4b48ee(0x1ce)+_0x15254c[_0x4b48ee(0x12c)]);}}}const _0x3db41f=await _0x15254c['json'](),_0x45b968=_0x3db41f[_0x4b48ee(0x105)]?.[_0x4b48ee(0xfa)]?.[_0x4b48ee(0x1cc)]||{},_0x2fc9ee=_0x3db41f[_0x4b48ee(0x105)]?.['attributes']?.['last_analysis_results']||{},_0x4a3456=Object[_0x4b48ee(0x18e)](_0x2fc9ee)[_0x4b48ee(0x175)](([_0x149702,_0x3d428a])=>({'name':_0x149702,'result':_0x3d428a[_0x4b48ee(0x198)]||_0x4b48ee(0x116),'category':_0x3d428a[_0x4b48ee(0x119)]||_0x4b48ee(0x1b9)}));return{'total':_0x45b968[_0x4b48ee(0x1b9)]+_0x45b968[_0x4b48ee(0x172)]+_0x45b968[_0x4b48ee(0x141)]+_0x45b968['undetected'],'malicious':_0x45b968['malicious']||0x0,'suspicious':_0x45b968[_0x4b48ee(0x141)]||0x0,'clean':_0x45b968[_0x4b48ee(0x1b9)]+_0x45b968[_0x4b48ee(0x1e7)],'scan_url':_0x4b48ee(0x1f8)+_0x510aec,'scan_date':_0x3db41f[_0x4b48ee(0x105)]?.[_0x4b48ee(0xfa)]?.[_0x4b48ee(0x1c0)],'vendors':_0x4a3456[_0x4b48ee(0x123)](0x0,0xa)};}catch(_0x490d8c){return console['error'](_0x4b48ee(0x13e),_0x490d8c),{'error':_0x490d8c['message']};}}async[a0_0x2bae22(0xfd)](_0x9c7814){const _0x11c2f3=a0_0x2bae22;try{const _0x53e972=await fetch(_0x11c2f3(0x127),{'method':_0x11c2f3(0x17d),'headers':{'x-apikey':this['VT_API_KEY'],'Content-Type':_0x11c2f3(0x1b0),'User-Agent':'NexusScan/1.0'},'body':_0x11c2f3(0x10f)+encodeURIComponent(_0x9c7814)});if(!_0x53e972['ok'])throw new Error(_0x11c2f3(0x185)+_0x53e972['status']+')');return await new Promise(_0x36eb01=>setTimeout(_0x36eb01,0x1388)),await this['getVirusTotalReport'](_0x9c7814);}catch(_0x4bb44a){return console['error'](_0x11c2f3(0x1c4),_0x4bb44a),{'error':_0x4bb44a[_0x11c2f3(0x1ab)]};}}async['comprehensiveScan'](_0x5fbacb,_0x4b7864=![]){const _0x4908f8=a0_0x2bae22,_0x437ed8=Date[_0x4908f8(0x1fa)]();if(!_0x4b7864&&this[_0x4908f8(0x135)]['has'](_0x5fbacb)){const _0x217510=this[_0x4908f8(0x135)][_0x4908f8(0x1e2)](_0x5fbacb),_0x958869=0x1e*0x3c*0x3e8;if(Date['now']()-_0x217510[_0x4908f8(0x125)]<_0x958869){console[_0x4908f8(0x207)](_0x4908f8(0x1ec),_0x5fbacb);const _0x486caa=await this[_0x4908f8(0x149)](_0x5fbacb);return _0x217510[_0x4908f8(0x12d)]=_0x486caa,_0x217510;}}const _0x174737={'url':_0x5fbacb,'timestamp':Date[_0x4908f8(0x1fa)](),'score':0x0,'threats':[],'sources':{},'status':'scanning'};try{const _0x350a6c=this['validateURL'](_0x5fbacb);_0x174737[_0x4908f8(0x11e)]=_0x350a6c,console['log']('NexusScan:\x20Starting\x20comprehensive\x20scan\x20for:',_0x350a6c);const [_0xb54971,_0x88ad95]=await Promise[_0x4908f8(0x10c)]([this[_0x4908f8(0x18b)](_0x350a6c),this[_0x4908f8(0x12f)](_0x350a6c)]);_0xb54971[_0x4908f8(0x19a)]===_0x4908f8(0x151)?_0x174737[_0x4908f8(0x113)][_0x4908f8(0x1d7)]=_0xb54971[_0x4908f8(0x11f)]:(console[_0x4908f8(0x108)](_0x4908f8(0x16c),_0xb54971[_0x4908f8(0x1ef)]),_0x174737[_0x4908f8(0x113)]['virustotal']={'error':_0xb54971[_0x4908f8(0x1ef)]?.[_0x4908f8(0x1ab)]||_0x4908f8(0x11c)});_0x88ad95[_0x4908f8(0x19a)]===_0x4908f8(0x151)?_0x174737[_0x4908f8(0x113)][_0x4908f8(0x144)]=_0x88ad95[_0x4908f8(0x11f)]:(console[_0x4908f8(0x108)](_0x4908f8(0x209),_0x88ad95[_0x4908f8(0x1ef)]),_0x174737[_0x4908f8(0x113)][_0x4908f8(0x144)]={'error':_0x88ad95[_0x4908f8(0x1ef)]?.[_0x4908f8(0x1ab)]||_0x4908f8(0x133)});_0x174737['score']=this[_0x4908f8(0x1cf)](_0x174737[_0x4908f8(0x113)]),_0x174737['threats']=this[_0x4908f8(0x1a5)](_0x174737[_0x4908f8(0x113)],_0x350a6c);try{const _0xfffdfc=new URL(_0x350a6c);_0xfffdfc[_0x4908f8(0x17a)]!==_0x4908f8(0x1dc)&&(_0x174737[_0x4908f8(0x1d8)]['push']('Not\x20using\x20secure\x20HTTPS\x20connection'),_0x174737[_0x4908f8(0x1eb)]+=0xa);}catch(_0x22e88c){_0x174737['threats']['push']('Invalid\x20URL\x20format'),_0x174737[_0x4908f8(0x1eb)]+=0x1e;}const _0x404bcc=await this[_0x4908f8(0x149)](_0x350a6c);_0x174737[_0x4908f8(0x12d)]=_0x404bcc;if(_0x404bcc[_0x4908f8(0x190)]>0x0){const _0x458a42=this[_0x4908f8(0x201)](_0x404bcc);_0x174737[_0x4908f8(0x1eb)]=Math[_0x4908f8(0x154)]((_0x174737['score']+_0x458a42)/0x2);}return _0x174737[_0x4908f8(0x1eb)]=Math[_0x4908f8(0x1c5)](_0x174737['score'],0x64),_0x174737['status']=_0x4908f8(0x1ed),_0x174737[_0x4908f8(0x195)]=Date[_0x4908f8(0x1fa)]()-_0x437ed8,await this[_0x4908f8(0x12a)](_0x174737),this[_0x4908f8(0x135)][_0x4908f8(0x1a8)](_0x5fbacb,_0x174737),console[_0x4908f8(0x207)](_0x4908f8(0x139),_0x174737['score']),_0x174737;}catch(_0x7b9d22){console[_0x4908f8(0x108)](_0x4908f8(0x18c),_0x7b9d22),_0x174737[_0x4908f8(0x19a)]=_0x4908f8(0x108),_0x174737[_0x4908f8(0x108)]=_0x7b9d22[_0x4908f8(0x1ab)];throw _0x7b9d22;}}[a0_0x2bae22(0x1cf)](_0x142fc5){const _0x21b61f=a0_0x2bae22;let _0xf329d9=0x0;if(_0x142fc5['virustotal']&&!_0x142fc5[_0x21b61f(0x1d7)][_0x21b61f(0x108)]){const _0x4ce2ce=_0x142fc5[_0x21b61f(0x1d7)];if(_0x4ce2ce[_0x21b61f(0x171)]>0x0){const _0x200aa1=_0x4ce2ce[_0x21b61f(0x172)]/_0x4ce2ce['total'],_0x399ff5=(_0x4ce2ce[_0x21b61f(0x141)]||0x0)/_0x4ce2ce[_0x21b61f(0x171)];_0xf329d9+=Math['min'](_0x200aa1*0x1e+_0x399ff5*0xf,0x28);}}if(_0x142fc5[_0x21b61f(0x144)]&&!_0x142fc5['urlscan']['error']){const _0x5d7053=_0x142fc5[_0x21b61f(0x144)];switch(_0x5d7053[_0x21b61f(0x16f)]){case _0x21b61f(0x172):_0xf329d9+=0x32;break;case _0x21b61f(0x141):_0xf329d9+=0x1e;break;case _0x21b61f(0x13c):_0xf329d9+=0x0;break;default:_0xf329d9+=0xa;}}return Math['min'](_0xf329d9,0x64);}[a0_0x2bae22(0x1a5)](_0x447f14,_0x29bfc9){const _0x3d5360=a0_0x2bae22,_0x2aaee7=[];if(_0x447f14['virustotal']&&!_0x447f14[_0x3d5360(0x1d7)][_0x3d5360(0x108)]){const _0x4166d5=_0x447f14[_0x3d5360(0x1d7)];_0x4166d5[_0x3d5360(0x172)]>0x0&&_0x2aaee7[_0x3d5360(0x196)](_0x4166d5[_0x3d5360(0x172)]+_0x3d5360(0x1bc)),_0x4166d5[_0x3d5360(0x141)]>0x0&&_0x2aaee7[_0x3d5360(0x196)](_0x4166d5[_0x3d5360(0x141)]+_0x3d5360(0x110));}if(_0x447f14[_0x3d5360(0x144)]&&!_0x447f14['urlscan'][_0x3d5360(0x108)]){const _0x2740c0=_0x447f14[_0x3d5360(0x144)];if(_0x2740c0[_0x3d5360(0x16f)]===_0x3d5360(0x172))_0x2aaee7[_0x3d5360(0x196)](_0x3d5360(0x13f));else _0x2740c0['verdict']===_0x3d5360(0x141)&&_0x2aaee7[_0x3d5360(0x196)]('urlscan.io\x20detected\x20suspicious\x20activity');_0x2740c0[_0x3d5360(0xef)]&&_0x2740c0[_0x3d5360(0xef)]['malicious']>0x0&&_0x2aaee7[_0x3d5360(0x196)](_0x2740c0[_0x3d5360(0xef)][_0x3d5360(0x172)]+'\x20malicious\x20resources\x20detected');}return _0x2aaee7;}async[a0_0x2bae22(0x136)](){const _0x1c223a=a0_0x2bae22;try{if(!chrome[_0x1c223a(0x194)])throw new Error(_0x1c223a(0x18a));console['log']('NexusScan:\x20Getting\x20bookmark\x20tree...');const _0x15adcc=await chrome['bookmarks'][_0x1c223a(0x14b)]();console['log'](_0x1c223a(0x1ca),_0x15adcc);const _0x15861d=this[_0x1c223a(0x1da)](_0x15adcc);return console[_0x1c223a(0x207)](_0x1c223a(0x14f),_0x15861d[_0x1c223a(0x14c)],_0x1c223a(0xf1)),_0x15861d;}catch(_0x50f12e){console['error']('NexusScan:\x20Failed\x20to\x20get\x20bookmarks:',_0x50f12e);throw new Error('Failed\x20to\x20access\x20bookmarks:\x20'+_0x50f12e['message']);}}[a0_0x2bae22(0x1da)](_0x1095ae){const _0x198c00=a0_0x2bae22,_0x3e9c75=[],_0x3fc3a5=_0x49406f=>{const _0x7b4e08=a0_0x3847;if(!Array['isArray'](_0x49406f))return;for(const _0x61cabb of _0x49406f){_0x61cabb[_0x7b4e08(0x11e)]&&_0x3e9c75[_0x7b4e08(0x196)]({'id':_0x61cabb['id'],'title':_0x61cabb['title']||_0x7b4e08(0x178),'url':_0x61cabb[_0x7b4e08(0x11e)],'dateAdded':_0x61cabb[_0x7b4e08(0x1af)],'parentId':_0x61cabb[_0x7b4e08(0x159)]}),_0x61cabb[_0x7b4e08(0x186)]&&Array[_0x7b4e08(0x111)](_0x61cabb[_0x7b4e08(0x186)])&&_0x3fc3a5(_0x61cabb[_0x7b4e08(0x186)]);}};_0x3fc3a5(_0x1095ae);const _0x470c39=_0x3e9c75[_0x198c00(0x191)](_0xe51d5f=>{const _0x3d82fd=_0x198c00;try{const _0x4d4d92=new URL(_0xe51d5f['url']);return[_0x3d82fd(0x202),'https:'][_0x3d82fd(0x169)](_0x4d4d92[_0x3d82fd(0x17a)]);}catch(_0x416fa9){return console['warn'](_0x3d82fd(0x1d1),_0xe51d5f[_0x3d82fd(0x11e)]),![];}});return console[_0x198c00(0x207)](_0x198c00(0x10d)+(_0x3e9c75['length']-_0x470c39[_0x198c00(0x14c)])+_0x198c00(0x126)),_0x470c39;}async['getBookmarkScanResults'](){const _0xc79ffb=a0_0x2bae22;try{const _0x29be14=_0xc79ffb(0x145),_0x1232fd=await chrome[_0xc79ffb(0x157)][_0xc79ffb(0x20d)][_0xc79ffb(0x1e2)](_0x29be14),_0x570f17=_0x1232fd[_0x29be14]||[];return console[_0xc79ffb(0x207)]('NexusScan:\x20Retrieved\x20bookmark\x20scan\x20results:',_0x570f17[_0xc79ffb(0x14c)],_0xc79ffb(0x18e)),_0x570f17;}catch(_0x374ecd){return console['error']('NexusScan:\x20Failed\x20to\x20get\x20bookmark\x20scan\x20results:',_0x374ecd),[];}}async['saveBookmarkScanResults'](_0x4a2ff1){const _0x2796c6=a0_0x2bae22;try{const _0x583b53=_0x2796c6(0x145),_0x2e4fa7=Array[_0x2796c6(0x111)](_0x4a2ff1)?_0x4a2ff1:Array[_0x2796c6(0x16b)](_0x4a2ff1);return await chrome[_0x2796c6(0x157)][_0x2796c6(0x20d)]['set']({[_0x583b53]:_0x2e4fa7}),console[_0x2796c6(0x207)](_0x2796c6(0x1f5),_0x2e4fa7[_0x2796c6(0x14c)],_0x2796c6(0x18e)),!![];}catch(_0xa867db){console[_0x2796c6(0x108)](_0x2796c6(0xfe),_0xa867db);throw _0xa867db;}}async[a0_0x2bae22(0x20a)](_0x1cdf1d,_0x166ccf){const _0x32d524=a0_0x2bae22;try{const _0x39c3c1=new Map();let _0x24990e=0x0;const _0x4018e8=_0x1cdf1d[_0x32d524(0x14c)];console[_0x32d524(0x207)](_0x32d524(0x1f1)+_0x4018e8+_0x32d524(0xf6));for(const _0xe03466 of _0x1cdf1d){try{_0x166ccf&&_0x166ccf({'current':_0x24990e+0x1,'total':_0x4018e8,'currentUrl':_0xe03466[_0x32d524(0x11e)],'status':_0x32d524(0x1de)});const _0x4f63dc=await this[_0x32d524(0x204)](_0xe03466[_0x32d524(0x11e)],![]);_0x39c3c1[_0x32d524(0x1a8)](_0xe03466[_0x32d524(0x11e)],{'status':'completed','score':_0x4f63dc['score'],'threats':_0x4f63dc[_0x32d524(0x1d8)],'lastScanned':Date[_0x32d524(0x1fa)](),'sources':{'virustotal':{'malicious':_0x4f63dc[_0x32d524(0x113)]['virustotal']?.[_0x32d524(0x172)]||0x0,'total':_0x4f63dc[_0x32d524(0x113)][_0x32d524(0x1d7)]?.[_0x32d524(0x171)]||0x0},'urlscan':{'verdict':_0x4f63dc[_0x32d524(0x113)][_0x32d524(0x144)]?.[_0x32d524(0x16f)]||_0x32d524(0x1d6)}}}),console[_0x32d524(0x207)](_0x32d524(0xf9)+_0xe03466[_0x32d524(0x11e)]+_0x32d524(0x1f9)+_0x4f63dc[_0x32d524(0x1eb)]);}catch(_0x207b04){console[_0x32d524(0x108)](_0x32d524(0x1f3)+_0xe03466[_0x32d524(0x11e)]+':',_0x207b04),_0x39c3c1[_0x32d524(0x1a8)](_0xe03466[_0x32d524(0x11e)],{'status':_0x32d524(0x108),'error':_0x207b04[_0x32d524(0x1ab)],'lastScanned':Date[_0x32d524(0x1fa)]()});}_0x24990e++,_0x24990e<_0x4018e8&&await new Promise(_0x14d2df=>setTimeout(_0x14d2df,0x7d0));}return await this['saveBookmarkScanResults'](Array[_0x32d524(0x16b)](_0x39c3c1[_0x32d524(0x18e)]())),console[_0x32d524(0x207)](_0x32d524(0x15c)+_0x24990e+'/'+_0x4018e8+'\x20bookmarks\x20processed'),{'completed':_0x24990e,'total':_0x4018e8,'results':Array['from'](_0x39c3c1[_0x32d524(0x18e)]())};}catch(_0x382edb){console[_0x32d524(0x108)]('NexusScan:\x20Bulk\x20bookmark\x20scan\x20failed:',_0x382edb);throw _0x382edb;}}async[a0_0x2bae22(0xf2)](){const _0x5efbe2=a0_0x2bae22;try{const _0x380724=_0x5efbe2(0x145);return await chrome[_0x5efbe2(0x157)][_0x5efbe2(0x20d)][_0x5efbe2(0x16d)](_0x380724),console[_0x5efbe2(0x207)](_0x5efbe2(0x197)),!![];}catch(_0x1d9efc){console[_0x5efbe2(0x108)](_0x5efbe2(0x143),_0x1d9efc);throw _0x1d9efc;}}async[a0_0x2bae22(0x1ee)](){const _0x3a08ba=a0_0x2bae22;try{const _0x2c9d96=await this[_0x3a08ba(0x136)](),_0x5a0cb7=await this['getBookmarkScanResults'](),_0x362f08=new Map(_0x5a0cb7),_0x44eb89={'metadata':{'exportDate':new Date()[_0x3a08ba(0x137)](),'totalBookmarks':_0x2c9d96[_0x3a08ba(0x14c)],'scannedBookmarks':_0x5a0cb7[_0x3a08ba(0x14c)],'version':'NexusScan\x20v1.0.0'},'bookmarks':_0x2c9d96[_0x3a08ba(0x175)](_0x444433=>{const _0x225920=_0x3a08ba,_0x75ad21=_0x362f08[_0x225920(0x1e2)](_0x444433[_0x225920(0x11e)]);return{'title':_0x444433[_0x225920(0x1cd)],'url':_0x444433['url'],'dateAdded':_0x444433[_0x225920(0x1af)]?new Date(_0x444433['dateAdded'])[_0x225920(0x137)]():null,'scanResult':_0x75ad21?{'status':_0x75ad21[_0x225920(0x19a)],'score':_0x75ad21[_0x225920(0x1eb)],'threats':_0x75ad21[_0x225920(0x1d8)],'lastScanned':_0x75ad21[_0x225920(0x122)]?new Date(_0x75ad21[_0x225920(0x122)])['toISOString']():null}:null};})};return _0x44eb89;}catch(_0x8ca957){console[_0x3a08ba(0x108)](_0x3a08ba(0x124),_0x8ca957);throw _0x8ca957;}}async[a0_0x2bae22(0x128)](_0x31207f){const _0x5c7e84=a0_0x2bae22;try{const _0x25ae78=_0x5c7e84(0x1e9),_0xf34502=await chrome[_0x5c7e84(0x157)][_0x5c7e84(0x20d)][_0x5c7e84(0x1e2)](_0x25ae78);let _0x15a8d2=_0xf34502[_0x25ae78]||[];const _0x554484={'id':this['generateFeedbackId'](),'url':_0x31207f['url'],'rating':_0x31207f[_0x5c7e84(0x1ad)],'comment':_0x31207f[_0x5c7e84(0x15b)]||'','category':_0x31207f[_0x5c7e84(0x119)],'timestamp':Date['now'](),'userAgent':navigator['userAgent'],'version':_0x5c7e84(0x167)};return _0x15a8d2[_0x5c7e84(0x155)](_0x554484),_0x15a8d2[_0x5c7e84(0x14c)]>0x3e8&&(_0x15a8d2=_0x15a8d2[_0x5c7e84(0x123)](0x0,0x3e8)),await chrome[_0x5c7e84(0x157)][_0x5c7e84(0x20d)][_0x5c7e84(0x1a8)]({[_0x25ae78]:_0x15a8d2}),console[_0x5c7e84(0x207)](_0x5c7e84(0x1f0),_0x554484['id']),_0x554484;}catch(_0x4adf54){console[_0x5c7e84(0x108)](_0x5c7e84(0x10b),_0x4adf54);throw _0x4adf54;}}async[a0_0x2bae22(0x149)](_0x2db0ca){const _0x33e698=a0_0x2bae22;try{const _0x24de46=_0x33e698(0x1e9),_0x46ef6a=await chrome[_0x33e698(0x157)][_0x33e698(0x20d)][_0x33e698(0x1e2)](_0x24de46),_0x4b471b=_0x46ef6a[_0x24de46]||[],_0x3e779d=_0x4b471b[_0x33e698(0x191)](_0x1d23ad=>_0x1d23ad['url']===_0x2db0ca);if(_0x3e779d[_0x33e698(0x14c)]===0x0)return{'totalRatings':0x0,'averageRating':0x0,'comments':[],'categories':{'safe':0x0,'suspicious':0x0,'malicious':0x0,'false_positive':0x0}};const _0x519447=_0x3e779d['length'],_0xb1d40=_0x3e779d['reduce']((_0xcbeebb,_0x9b12d6)=>_0xcbeebb+_0x9b12d6[_0x33e698(0x1ad)],0x0)/_0x519447,_0x139014={'safe':_0x3e779d[_0x33e698(0x191)](_0xec5b3a=>_0xec5b3a[_0x33e698(0x119)]===_0x33e698(0x166))[_0x33e698(0x14c)],'suspicious':_0x3e779d[_0x33e698(0x191)](_0x587822=>_0x587822[_0x33e698(0x119)]==='suspicious')[_0x33e698(0x14c)],'malicious':_0x3e779d['filter'](_0x4db439=>_0x4db439[_0x33e698(0x119)]===_0x33e698(0x172))[_0x33e698(0x14c)],'false_positive':_0x3e779d[_0x33e698(0x191)](_0x257ac0=>_0x257ac0['category']===_0x33e698(0x17b))[_0x33e698(0x14c)]},_0x900014=_0x3e779d[_0x33e698(0x191)](_0x2e33c7=>_0x2e33c7['comment']&&_0x2e33c7[_0x33e698(0x15b)][_0x33e698(0x182)]())[_0x33e698(0x175)](_0x45a895=>({'comment':_0x45a895[_0x33e698(0x15b)],'rating':_0x45a895[_0x33e698(0x1ad)],'category':_0x45a895[_0x33e698(0x119)],'timestamp':_0x45a895['timestamp'],'id':_0x45a895['id']}))[_0x33e698(0xff)]((_0x43eabe,_0x3f5ac3)=>_0x3f5ac3[_0x33e698(0x125)]-_0x43eabe[_0x33e698(0x125)])['slice'](0x0,0xa);return{'totalRatings':_0x519447,'averageRating':Math[_0x33e698(0x154)](_0xb1d40*0xa)/0xa,'comments':_0x900014,'categories':_0x139014};}catch(_0x5505ac){return console[_0x33e698(0x108)]('NexusScan:\x20Failed\x20to\x20get\x20feedback:',_0x5505ac),{'totalRatings':0x0,'averageRating':0x0,'comments':[],'categories':{'safe':0x0,'suspicious':0x0,'malicious':0x0,'false_positive':0x0}};}}async[a0_0x2bae22(0x1fb)](){const _0x368a6e=a0_0x2bae22;try{const _0x29c1df=_0x368a6e(0x1e9),_0x446781=await chrome['storage'][_0x368a6e(0x20d)][_0x368a6e(0x1e2)](_0x29c1df),_0x406bf2=_0x446781[_0x29c1df]||[],_0x42e937=Date['now'](),_0x30a212=_0x42e937-0x18*0x3c*0x3c*0x3e8;return{'total':_0x406bf2[_0x368a6e(0x14c)],'today':_0x406bf2[_0x368a6e(0x191)](_0x3af15f=>_0x3af15f[_0x368a6e(0x125)]>_0x30a212)[_0x368a6e(0x14c)],'categories':{'safe':_0x406bf2[_0x368a6e(0x191)](_0x463234=>_0x463234[_0x368a6e(0x119)]===_0x368a6e(0x166))['length'],'suspicious':_0x406bf2[_0x368a6e(0x191)](_0x45f005=>_0x45f005[_0x368a6e(0x119)]===_0x368a6e(0x141))['length'],'malicious':_0x406bf2[_0x368a6e(0x191)](_0x24c14f=>_0x24c14f['category']===_0x368a6e(0x172))['length'],'false_positive':_0x406bf2['filter'](_0x9053ad=>_0x9053ad[_0x368a6e(0x119)]===_0x368a6e(0x17b))[_0x368a6e(0x14c)]},'averageRating':_0x406bf2[_0x368a6e(0x14c)]>0x0?Math[_0x368a6e(0x154)](_0x406bf2[_0x368a6e(0x1a9)]((_0x5be26b,_0x7b56eb)=>_0x5be26b+_0x7b56eb[_0x368a6e(0x1ad)],0x0)/_0x406bf2[_0x368a6e(0x14c)]*0xa)/0xa:0x0};}catch(_0x5690d2){return console[_0x368a6e(0x108)]('NexusScan:\x20Failed\x20to\x20get\x20feedback\x20stats:',_0x5690d2),{'total':0x0,'today':0x0,'categories':{'safe':0x0,'suspicious':0x0,'malicious':0x0,'false_positive':0x0},'averageRating':0x0};}}async[a0_0x2bae22(0x1f4)](_0x3d2786){const _0x212405=a0_0x2bae22;try{const _0x5d7a7a=_0x212405(0x118),_0x2ddb54=await chrome['storage'][_0x212405(0x20d)][_0x212405(0x1e2)](_0x5d7a7a);let _0x215741=_0x2ddb54[_0x5d7a7a]||[];const _0x5f1551={'id':this[_0x212405(0x1d5)](),'url':_0x3d2786['url'],'type':_0x3d2786[_0x212405(0x15d)],'description':_0x3d2786[_0x212405(0x203)]||'','evidence':_0x3d2786[_0x212405(0x100)]||'','timestamp':Date['now'](),'status':'pending','userAgent':navigator[_0x212405(0x1fe)]};return _0x215741[_0x212405(0x155)](_0x5f1551),_0x215741['length']>0x1f4&&(_0x215741=_0x215741[_0x212405(0x123)](0x0,0x1f4)),await chrome[_0x212405(0x157)]['local'][_0x212405(0x1a8)]({[_0x5d7a7a]:_0x215741}),console[_0x212405(0x207)]('NexusScan:\x20URL\x20report\x20submitted:',_0x5f1551['id']),_0x5f1551;}catch(_0x4bfe9b){console['error']('NexusScan:\x20Failed\x20to\x20submit\x20report:',_0x4bfe9b);throw _0x4bfe9b;}}async[a0_0x2bae22(0x15f)](){const _0x1555a4=a0_0x2bae22;try{const _0x4aea31='nexusscan_community_feedback',_0x198e21=await chrome['storage'][_0x1555a4(0x20d)][_0x1555a4(0x1e2)](_0x4aea31),_0x3f79c9=_0x198e21[_0x4aea31]||[];return _0x3f79c9[_0x1555a4(0x123)](0x0,0x14)['map'](_0x435c4c=>({'id':_0x435c4c['id'],'url':_0x435c4c['url'],'rating':_0x435c4c[_0x1555a4(0x1ad)],'comment':_0x435c4c[_0x1555a4(0x15b)],'category':_0x435c4c['category'],'timestamp':_0x435c4c[_0x1555a4(0x125)]}));}catch(_0x5c97d9){return console[_0x1555a4(0x108)](_0x1555a4(0x1b6),_0x5c97d9),[];}}async[a0_0x2bae22(0x1e6)](_0x3b68a7){const _0xfa8f37=a0_0x2bae22;try{const _0x26205a='nexusscan_community_feedback',_0x4072d4=await chrome[_0xfa8f37(0x157)][_0xfa8f37(0x20d)][_0xfa8f37(0x1e2)](_0x26205a);let _0x18b27c=_0x4072d4[_0x26205a]||[];const _0x433b78=_0x18b27c['length'];_0x18b27c=_0x18b27c[_0xfa8f37(0x191)](_0x3713a3=>_0x3713a3['id']!==_0x3b68a7);if(_0x18b27c[_0xfa8f37(0x14c)]<_0x433b78)return await chrome[_0xfa8f37(0x157)][_0xfa8f37(0x20d)][_0xfa8f37(0x1a8)]({[_0x26205a]:_0x18b27c}),console[_0xfa8f37(0x207)](_0xfa8f37(0x1df),_0x3b68a7),!![];return![];}catch(_0xf97a0b){console[_0xfa8f37(0x108)](_0xfa8f37(0x11a),_0xf97a0b);throw _0xf97a0b;}}async[a0_0x2bae22(0x12a)](_0x575a31){const _0x4df8b2=a0_0x2bae22;try{const _0x5c32bc='nexusscan_scan_history',_0xcdcc3b=await chrome[_0x4df8b2(0x157)][_0x4df8b2(0x20d)]['get'](_0x5c32bc);let _0x22b511=_0xcdcc3b[_0x5c32bc]||[];const _0x4e2f9b={'id':this[_0x4df8b2(0x193)](),'url':_0x575a31[_0x4df8b2(0x11e)],'timestamp':_0x575a31[_0x4df8b2(0x125)],'score':_0x575a31['score'],'status':_0x575a31['status'],'threats':_0x575a31[_0x4df8b2(0x1d8)],'sources':{'virustotal':{'total':_0x575a31[_0x4df8b2(0x113)][_0x4df8b2(0x1d7)]?.[_0x4df8b2(0x171)]||0x0,'malicious':_0x575a31[_0x4df8b2(0x113)][_0x4df8b2(0x1d7)]?.[_0x4df8b2(0x172)]||0x0,'suspicious':_0x575a31[_0x4df8b2(0x113)]['virustotal']?.[_0x4df8b2(0x141)]||0x0,'hasError':!!_0x575a31[_0x4df8b2(0x113)][_0x4df8b2(0x1d7)]?.[_0x4df8b2(0x108)]},'urlscan':{'verdict':_0x575a31['sources']['urlscan']?.['verdict']||'unknown','uuid':_0x575a31[_0x4df8b2(0x113)]['urlscan']?.[_0x4df8b2(0x1b1)],'hasError':!!_0x575a31['sources']['urlscan']?.[_0x4df8b2(0x108)]}},'scanDuration':_0x575a31[_0x4df8b2(0x195)]||0x0};return _0x22b511[_0x4df8b2(0x155)](_0x4e2f9b),_0x22b511[_0x4df8b2(0x14c)]>0x64&&(_0x22b511=_0x22b511[_0x4df8b2(0x123)](0x0,0x64)),await chrome[_0x4df8b2(0x157)]['local'][_0x4df8b2(0x1a8)]({[_0x5c32bc]:_0x22b511}),_0x4e2f9b['id'];}catch(_0x40ef6b){console[_0x4df8b2(0x108)](_0x4df8b2(0x1b2),_0x40ef6b);}}async[a0_0x2bae22(0x1ac)](_0x248f99=0x32){const _0x416c6d=a0_0x2bae22;try{const _0x3926dc=_0x416c6d(0x1fc),_0x1868be=await chrome[_0x416c6d(0x157)][_0x416c6d(0x20d)][_0x416c6d(0x1e2)](_0x3926dc),_0x10de2c=_0x1868be[_0x3926dc]||[];return _0x248f99?_0x10de2c[_0x416c6d(0x123)](0x0,_0x248f99):_0x10de2c;}catch(_0x4c7e64){return console['error'](_0x416c6d(0x168),_0x4c7e64),[];}}async[a0_0x2bae22(0xf0)](){const _0x4f9563=a0_0x2bae22;try{const _0x5b5723='nexusscan_scan_history';return await chrome['storage'][_0x4f9563(0x20d)]['remove'](_0x5b5723),!![];}catch(_0x1c5b7e){return console[_0x4f9563(0x108)](_0x4f9563(0x106),_0x1c5b7e),![];}}async[a0_0x2bae22(0x130)](){const _0x464f9f=a0_0x2bae22;try{const _0x4d5ffd=await this[_0x464f9f(0x1ac)](),_0x2da684=Date[_0x464f9f(0x1fa)](),_0x438c39=_0x2da684-0x18*0x3c*0x3c*0x3e8;return{'total':_0x4d5ffd[_0x464f9f(0x14c)],'today':_0x4d5ffd['filter'](_0x4cae24=>_0x4cae24[_0x464f9f(0x125)]>_0x438c39)[_0x464f9f(0x14c)],'dangerousScans':_0x4d5ffd['filter'](_0x579411=>_0x579411[_0x464f9f(0x1eb)]>=0x46)[_0x464f9f(0x14c)],'averageScore':_0x4d5ffd[_0x464f9f(0x14c)]>0x0?Math['round'](_0x4d5ffd[_0x464f9f(0x1a9)]((_0xb29f8e,_0x45ef3e)=>_0xb29f8e+_0x45ef3e[_0x464f9f(0x1eb)],0x0)/_0x4d5ffd[_0x464f9f(0x14c)]):0x0};}catch(_0x35bb85){return console[_0x464f9f(0x108)]('NexusScan:\x20Failed\x20to\x20get\x20history\x20stats:',_0x35bb85),{'total':0x0,'today':0x0,'dangerousScans':0x0,'averageScore':0x0};}}async[a0_0x2bae22(0x1db)](_0x2f0869=a0_0x2bae22(0x1fd)){const _0x4c6195=a0_0x2bae22;try{const _0xdc8238=await this[_0x4c6195(0x1ac)](),_0x160e30=await this[_0x4c6195(0x130)](),_0x4cefd8={'metadata':{'exportDate':new Date()[_0x4c6195(0x137)](),'totalScans':_0xdc8238[_0x4c6195(0x14c)],'version':'NexusScan\x20v1.0.0'},'statistics':_0x160e30,'scans':_0xdc8238[_0x4c6195(0x175)](_0x21a8a1=>({..._0x21a8a1,'timestamp':new Date(_0x21a8a1['timestamp'])[_0x4c6195(0x137)](),'formattedDate':new Date(_0x21a8a1[_0x4c6195(0x125)])[_0x4c6195(0x1a2)]()}))};return _0x4cefd8;}catch(_0x538497){console[_0x4c6195(0x108)](_0x4c6195(0x188),_0x538497);throw _0x538497;}}[a0_0x2bae22(0x201)](_0x265759){const _0x1641f2=a0_0x2bae22;if(_0x265759['totalRatings']===0x0)return 0x0;const _0x1083e2=(_0x265759['averageRating']-0x1)/0x4*0x64,_0x799582=Math[_0x1641f2(0x1c5)](_0x265759[_0x1641f2(0x190)]/0xa,0x1);return Math[_0x1641f2(0x154)](_0x1083e2*_0x799582);}['validateURL'](_0x46e0d5){const _0x411e29=a0_0x2bae22;try{const _0x562c8d=new URL(_0x46e0d5);if(![_0x411e29(0x202),_0x411e29(0x1dc)][_0x411e29(0x169)](_0x562c8d[_0x411e29(0x17a)]))throw new Error(_0x411e29(0x11d));return _0x562c8d['toString']();}catch(_0x2efadb){throw new Error('Invalid\x20URL\x20format:\x20'+_0x2efadb[_0x411e29(0x1ab)]);}}async[a0_0x2bae22(0x176)](_0x5ba333,_0x19431a){const _0x21023d=a0_0x2bae22;_0x19431a&&chrome['tabs'][_0x21023d(0x12b)](_0x19431a,{'url':'about:blank'});}[a0_0x2bae22(0xec)](){const _0x1aab0d=a0_0x2bae22;return _0x1aab0d(0x1c8)+Date[_0x1aab0d(0x1fa)]()+'_'+Math['random']()[_0x1aab0d(0x1e0)](0x24)[_0x1aab0d(0x17f)](0x2,0x9);}[a0_0x2bae22(0x1d5)](){const _0x1d0a5e=a0_0x2bae22;return'nexusscan_report_'+Date[_0x1d0a5e(0x1fa)]()+'_'+Math[_0x1d0a5e(0x134)]()['toString'](0x24)[_0x1d0a5e(0x17f)](0x2,0x9);}[a0_0x2bae22(0x193)](){const _0x1e62dd=a0_0x2bae22;return _0x1e62dd(0x101)+Date[_0x1e62dd(0x1fa)]()+'_'+Math[_0x1e62dd(0x134)]()[_0x1e62dd(0x1e0)](0x24)[_0x1e62dd(0x17f)](0x2,0x9);}}const threatIntel=new ThreatIntelligence();chrome[a0_0x2bae22(0x153)][a0_0x2bae22(0x156)][a0_0x2bae22(0x161)](()=>{const _0x4551d8=a0_0x2bae22;console['log'](_0x4551d8(0x129));});